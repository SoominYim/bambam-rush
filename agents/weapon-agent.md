# Weapon Agent

## 목적
- 무기 설계/구현/검증의 단일 기준 문서다.
- 목표는 "컨셉 일관성 + 밸런스 안정성 + 코드 확장성"을 동시에 만족하는 것이다.

## 무기의 정의
- 무기는 단순 데미지 오브젝트가 아니라 `패턴 + 수치 + 상태`의 묶음이다.
- 무기는 패턴을 선택하고, 패턴에 필요한 데이터를 공급한다.
- 무기별 독립 로직을 늘리지 말고 패턴 공용 로직으로 흡수한다.

## 책임 분리 (강제)
- `weaponRegistry.ts`: 데이터만 담당
  - 포함: pattern, baseStats, level scaling, evolution 조건
  - 금지: 거리 계산, 타겟 탐색, update 로직, 상태 판단
- `weaponSystem.ts`: 생성 타이밍만 담당
  - 포함: 쿨타임 체크, count만큼 생성, fire/spawn 함수 호출
  - 금지: 이동/충돌/타겟팅 계산
- `projectile/entity`: 전투 동작 본체
  - 포함: update(dt), 위치/상태 전환, 충돌 판정, hitCooldown 처리

## 패턴 정의
- 패턴은 "어떻게 공격하나"가 아니라 "월드에 어떻게 존재하나"를 정의한다.
- `projectile`: 생성 -> 이동 -> 수명 종료
- `orbit`: 플레이어 주변 상시 회전
- `area/aura`: 영역 유지 + 주기 피해

## 패턴별 최소 구현 기준
### ORBIT
- 필수: 플레이어 기준 회전, 반경, 각도 누적, 충돌 데미지
- 선택: 타겟 추적, 상태 전환(attack/return), 특수 효과

### PROJECTILE
- 필수: 방향, 속도, 수명/화면 밖 제거
- 선택: 추적, 관통, 튕김

### AREA/AURA
- 필수: 중심 좌표, 반경, tick 간격 피해
- 선택: 흡인, 감속, 상태 부여

## 밸런스 체크 (필수)
- 시간대 분리: 초반(1~3분), 중반(4~8분), 후반(9분+)
- 지표: DPS 외 `사거리/범위/쿨다운/투사체 속도/관통/군중제어/리스크`
- 목표: "최강"이 아니라 "선택 이유가 분명한 무기"

## 컨셉 체크 (필수)
- 설명 문구, 실제 체감, VFX/SFX가 일치해야 한다.
- 컨셉과 반대되는 동작(예: 묵직한 무기의 과도한 연사)은 금지한다.

## 구현 체크리스트
- [ ] ID/타입/레지스트리 등록
- [ ] baseStats 정의
- [ ] level scaling 정의 (행동 변경보다 수치 조정 우선)
- [ ] weaponSystem 패턴 분기 연결
- [ ] projectile/entity 동작 연결
- [ ] 툴팁/문서 동기화

## 성능 체크
- 상시 객체(orbit/aura/minion)는 tick/hitCooldown을 반드시 둔다.
- 프레임 드랍 유발 이펙트는 옵션 또는 샘플링 제한을 둔다.
- 충돌 체크는 최소 범위부터 단계적으로 확장한다.

## 리뷰 우선순위 기준
- `critical`: 게임 진행 불가, 즉사급 버그, 심각한 성능 붕괴
- `high`: 무기 의도와 다르게 동작, 밸런스 붕괴
- `medium`: 체감 저하, 특정 상황 오류, 문서 불일치
- `low`: 표현/가독성 개선, 사소한 튜닝

## 자주 터지는 실수
- registry에 로직 삽입
- 첫 구현부터 상태머신/추적/진화를 과도하게 포함
- weaponSystem에서 이동/충돌 처리
- 단일 projectile 클래스에 모든 패턴 억지 통합

## 완료 기준
- 의도한 컨셉이 플레이 영상 30초 내 식별된다.
- 시간대별 밸런스 체크를 통과한다.
- 책임 분리 규칙을 위반하지 않는다.
