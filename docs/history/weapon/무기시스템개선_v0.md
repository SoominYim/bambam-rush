# 무기 시스템 개선 계획

## 1. 문제 분석

현재 `weaponRegistry.ts`에는 총 **20개 무기**가 정의되어 있으나,  
`weaponSystem.ts`에서는 아래 **4개 패턴만 구현**되어 있습니다.

### ✅ 구현된 패턴

- `projectile` : 추적 미사일
- `line` : 직선 발사
- `chain` : 체인 라이트닝
- `area` : 장판 생성

### ❌ 미구현 패턴 (16개)

- `orbit`
- `return`
- `nova`
- `trap`
- `beam`
- `minion`
- `arc`
- `vortex`
- `bounce`
- `aura`
- `sky`
- `spread`
- `gas`
- `linear`
- `nuke`

이로 인해 다수의 무기가 실제 게임에서 정상 동작하지 않으며,  
확장성과 유지보수 측면에서도 구조 개선이 필요한 상황입니다.

---

## 2. 제안 변경사항

### 2.1 weaponSystem.ts 확장

각 무기 패턴에 대응하는 발사 / 생성 함수를 추가합니다.

#### [MODIFY] `weaponSystem.ts`

##### 추가할 함수 목록

| 함수명           | 설명               | 대응 무기 |
| ---------------- | ------------------ | --------- |
| `fireOrbit()`    | 플레이어 주위 회전 | W01, W08  |
| `fireReturn()`   | 부메랑             | W06       |
| `fireNova()`     | 플레이어 중심 폭발 | W07       |
| `spawnTrap()`    | 지뢰 설치          | W09       |
| `fireBeam()`     | 레이저 빔          | W10       |
| `summonMinion()` | 미니언 소환        | W11       |
| `fireArc()`      | 포물선 투사체      | W12       |
| `spawnVortex()`  | 블랙홀 생성        | W13       |
| `fireBounce()`   | 튕기는 투사체      | W14       |
| `createAura()`   | 지속 오라          | W15       |
| `fireSky()`      | 하늘에서 낙하      | W16       |
| `fireSpread()`   | 부채꼴 발사        | W17       |
| `spawnGas()`     | 이동하는 독 구름   | W18       |
| `fireLinear()`   | 직선 투사체        | W19       |
| `fireNuke()`     | 화면 전체 공격     | W20       |

---

### 2.2 triggerWeaponEffect 함수 확장

```ts
switch (def.pattern) {
  case "projectile": fireProjectile(...); break;
  case "line": fireLine(...); break;
  case "chain": fireChain(...); break;
  case "area": spawnArea(...); break;
  case "orbit": fireOrbit(...); break;
  case "return": fireReturn(...); break;
  case "nova": fireNova(...); break;
  case "trap": spawnTrap(...); break;
  case "beam": fireBeam(...); break;
  case "minion": summonMinion(...); break;
  case "arc": fireArc(...); break;
  case "vortex": spawnVortex(...); break;
  case "bounce": fireBounce(...); break;
  case "aura": createAura(...); break;
  case "sky": fireSky(...); break;
  case "spread": fireSpread(...); break;
  case "gas": spawnGas(...); break;
  case "linear": fireLinear(...); break;
  case "nuke": fireNuke(...); break;
}
```

### 3. projectile.ts 확장

3.1 새로운 투사체 동작 타입 추가
[MODIFY] projectile.ts

추가할 동작 타입:

ORBIT : 플레이어 주위 회전

RETURN : 일정 거리 후 되돌아옴

BOUNCE : 벽 / 화면 끝에서 튕김

MINION : 적 추적 AI

ARC : 포물선 궤적

VORTEX : 적을 끌어당김

GAS : 랜덤 이동

각 타입별로 update() 로직을 구현하여
투사체의 이동, 충돌, 수명 관리를 담당합니다.

### 4. 기존 코드 버그 수정

4.1 weaponSystem.ts Lint 에러 수정
문제

stats.speed가 undefined일 수 있음

수정안

```ts
// 스케일 적용 시
if (scale.speed && stats.speed !== undefined) {
  stats.speed += scale.speed;
}

// 패시브 적용 시
if (stats.speed !== undefined) {
  stats.speed *= 1 + pVal;
}
```

### 5. 검증 계획

5.1 자동 테스트

각 무기 패턴별 발사 정상 여부 확인

레벨업 시 스탯 증가 확인

패시브 적용 정상 여부 확인

5.2 수동 검증

각 캐릭터로 게임 시작

시작 무기 정상 작동 여부 확인

레벨업 후 무기 선택 시 정상 동작 확인

진화 조건 충족 시 무기 진화 확인
