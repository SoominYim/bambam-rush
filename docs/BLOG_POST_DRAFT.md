# 개발기: 스네이크 기반 서바이벌 게임의 핵심 기술과 설계 전략

## 1. 서론: 기존 서바이벌 장르의 한계 극복

일반적인 뱀파이어 서바이벌 라이크 게임에서 플레이어 캐릭터는 전장의 중심점에 고정된 단일 타격 판정을 가집니다. 본 프로젝트는 이러한 정적인 구조에서 벗어나 플레이어의 물리적 형태가 곧 전략적 자산이 되는 '스네이크 메카닉'을 도입하는 것에서 시작되었습니다.

---

## 2. 핵심 기술 과제와 해결책

### 2.1 물리적으로 연결된 무기 소켓 (Linked Weapon Sockets)

가장 큰 난제는 머리의 움직임을 따라가는 수많은 꼬리 세그먼트들이 실시간으로 무기 엔티티와 동기화되어야 한다는 점이었습니다.

- **해결책**: 각 세그먼트를 독립적인 `GameObject`로 정의하고, 무기 생성 시 해당 세그먼트의 `id`를 `parentID`로 주입했습니다. 무기 로직 내에서 매 프레임 부모의 위치를 참조하여 자신의 위치를 갱신하도록 설계함으로써, 뱀이 휘어질 때 무기들도 자연스럽게 그 궤적을 따르며 거대한 방어선을 형성하게 되었습니다.

### 2.2 상태 기반 행동 로직 (State-Based Behavior Map)

단순 투사체 기반에서 벗어나 복합적인 움직임을 구현하기 위해 '행동 맵(Behavior Map)' 아키텍처를 구축했습니다.

- **ORBIT_STAB 패턴**: 단순 공전과 조준 타격을 결합하기 위해 내부 상태 기계를 도입했습니다. 적과의 거리를 연산하여 `ORBIT` 상태에서 `STAB` 상태로 전환하고, 찌르기 완료 후 원거리 보간을 통해 `RECOVER` 상태로 복귀하는 일련의 과정을 캡슐화했습니다. 이는 애니메이션 없이 오직 코드만으로 무기의 '무게감'과 '속도감'을 구현하는 데 핵심적인 역할을 했습니다.

### 2.3 대규모 엔티티 연산 최적화 (Spatial Partitioning)

화면상에 존재하는 수많은 적과 무기 간의 충돌 판정은 성능 저하의 주요 원인입니다.

- **해결책**: 전체 전장을 격자(Grid) 단위로 분할하여 관리하는 `SpatialGrid` 시스템을 도입했습니다. 각 엔티티는 자신의 좌표에 따라 특정 셀에 등록되며, 무기는 주변 9개 셀에 속한 적들만 검사합니다. 이를 통해 기하급수적으로 늘어나는 연산량을 선형적으로 제어할 수 있었습니다.

---

## 3. 설계 철학: 데이터 중심 설계 (Data-Driven Design)

코드의 재사용성을 극대화하기 위해 `weaponRegistry.ts`와 `projectileBehaviors.ts`를 철저히 분리했습니다. 새로운 무기를 추가할 때 기존 코드를 수정할 필요 없이 데이터 등록과 행동 함수 정의만으로 확장이 가능합니다. 이는 개발 속도를 비약적으로 향상시켰으며, 기획적 변경 사항에 유연하게 대응할 수 있는 기반이 되었습니다.

---

## 4. 결론 및 향후 과제

본 프로젝트를 통해 단순한 복제가 아닌 장르의 메카닉적 재해석이 주는 재미를 확인할 수 있었습니다. 향후에는 각 세그먼트 간의 원소 시너지 시스템을 더욱 고도화하여, 스네이크의 조합에 따라 전장의 양상이 완전히 바뀌는 고난도 전략성을 확보할 예정입니다.
